<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Interactive Word Cloud</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-cloud/1.2.5/d3.layout.cloud.min.js"></script>
  <style>
    body { background: #fafafa; }
    svg { width: 100%; height: 100vh; }
    text {
      cursor: pointer;
      transition: transform 0.3s ease-in-out;
    }
    text:hover {
      fill: orange;
      transform: scale(1.2);
    }
  </style>
</head>
<body>
  <svg id="wordcloud"></svg>

  <script>
    d3.json("word_data.json").then(function(words) {
      const layout = d3.layout.cloud()
        .size([1000, 600])
        .words(words.map(d => ({...d, size: d.size})))
        .padding(5)
        .rotate(() => ~~(Math.random() * 2) * 90)
        .font("Impact")
        .fontSize(d => d.size)
        .on("end", draw);

      layout.start();

      function draw(words) {
        const svg = d3.select("#wordcloud")
          .attr("width", 1000)
          .attr("height", 600)
          .append("g")
          .attr("transform", "translate(500,300)");

        svg.selectAll("text")
          .data(words)
          .enter().append("text")
          .style("font-size", d => d.size + "px")
          .style("fill", () => d3.schemeCategory10[Math.floor(Math.random() * 10)])
          .attr("text-anchor", "middle")
          .attr("transform", d => `translate(${d.x},${d.y})rotate(${d.rotate})`)
          .text(d => d.text)
          .on("click", function(event, d) {
            alert("ðŸ“‘ ê´€ë ¨ ê¸°ì‚¬:\n" + d.articles.join("\n"));
          })
          // ë‘¥ì‹¤ë‘¥ì‹¤ ë– ë‹¤ë‹ˆëŠ” ì• ë‹ˆë©”ì´ì…˜
          .transition()
          .duration(2000)
          .ease(d3.easeSinInOut)
          .attr("transform", d => `translate(${d.x},${d.y + (Math.random()*10 - 5)})rotate(${d.rotate})`)
          .on("end", function repeat(d) {
            d3.select(this)
              .transition()
              .duration(2000)
              .ease(d3.easeSinInOut)
              .attr("transform", `translate(${d.x},${d.y + (Math.random()*10 - 5)})rotate(${d.rotate})`)
              .on("end", repeat);
          });
      }
    });
  </script>
</body>
</html>
